      SUBROUTINE SUB_TRIPGEN5
      IMPLICIT INTEGER(A-Z)
C***********************************************************************
C        1         2         3         4         5         6         7
C23456789012345678901234567890123456789012345678901234567890123456789012
C***********************************************************************
C
C     THIS IS THE FIFTH PROGRAM IN THE REVISED HOUSEHOLD TRIP
C     GENERATION.  IT MULTIPLIES THE WORKER AND NONWORKER TRIP
C     GENERATION RATES TIMES THE PERSONS RESIDING IN GROUP QUARTERS
C     (EXCLUSIVE OF INSTITUTIONALIZED PERSONS) TO OBTAIN GROUP 
C     QUARTERS TRIP PRODUCTIONS, WHICH EQUAL ATTRACTIONS.  THE OUTPUT
C     FILE CONTAINS TRIP PRODUCTIONS FOR EACH TG SUBZONE.
C
C     THIS VERSION IS FOR SUN FORTRAN. 
C
C     EASH, SEPTEMBER 1995
C
C***********************************************************************
C
C     REVISIONS FOR PRAIRIE PARKWAY TRIP GENERATION IN THIS VERSION.
C     1.  CHANGES IN INPUT-OUTPUT FILE NAMES AND FORMATS
C     2.  DESIGNED FOR SOCIOECONOMIC ZONES PREPARED BY SUHAIL ALCHALABI
C         FOR PRAIRIE PARKWAY (COMBINATION OF TG SUBZONES AND 
C         SECTIONS.
C     
C     EASH, JUNE 2003
C
C***********************************************************************
C
C     REVISED FOR I-290 HOV WORK IN NOVEMBER 2006.  CHANGED TO 
C     ACCOMODATE NEW TEMPORARY FILE FORMATS AND PUMS SUMMARIES.
C
C     EASH, NOVEMBER 2006
C
C***********************************************************************
C
C     REVISED FOR CMAP TRIP GENERATION UPDATE IN JANUARY 2009. 
C     SUBROUTINE REVISED TO ACCOMODATE NEW CMAP SURVEY TRIP RATES AND 
C     NEW SET OF TRIP TYPES.  HOME-WORK TRIP RATES FOR WORKERS IN 
C     GROUP QUARTERS ADJUSTED BASED ON ACS PUMS GQ DATA FOR 2006-2007. 
C
C     EASH, JANUARY 2009
C
C***********************************************************************
C
C     REVISED AGAIN IN PROJECT TO READ HOME-WORKPLACE RATE
C
C     EASH, MARCH 2009 
C
C***********************************************************************
C
C     REVISIONS FOR ENUMERATED HOUSEHOLDS VERSION
C     
C     GQ_IN.TXT (COMMA DELIMITED)
C
C       FIELD1:  TG SUBZONE NUMBER
C       FIELD2:  PERSONS IN MILITARY QUARTERS
C       FIELD3:  PERSONS IN COLLEGE/UNIVERSITY DORMS
C       FIELD4:  ADULTS IN OTHER NONINSTITUTIONALIZED GROUP QUARTERS
C                LESS THAN 65 YEARS OLD
C       FIELD5:  ADULTS IN OTHER NONINSTITUTIONALIZED GROUP QUARTERS
C                65 AND OLDER
C
C     ALL TRIP RATES AND WORKER PROPORTIONS ARE NOW HARDCODED
C
C     NONMOTORIZED TRIPS REMOVED FROM GROUP QUARTERS TRIPS IN THIS 
C       SUBROUTINE
C                 
C     EASH, JUNE 2012 
C
C***********************************************************************
      INCLUDE 'COMMON_PARAM.FI'
	INCLUDE 'COMMON_GEOG.FI'
      INCLUDE 'COMMON_GQ.FI'
C
C     PRODUCTION ARRAY:  TRIP PURPOSE BY GQ TYPE
C       1.  MILITARY
C       2.  COLLEGE/UNIVERSITY DORM
C       3.  OTHER AGED 18-64
C       4.  OTHER AGED 65 PLUS
C
      REAL*4  PRODS(33,4)
C
C     GQ TRIP GENERATION INPUT FILE FROM TG DATABASE IS UNIT 40. 
C     THIS FILE HAS THE TG SUBZONE AND WORKERS AND NONWORKERS
C     WHO RESIDE IN GROUP QUARTERS.
C
      OPEN (UNIT=40,FILE='GQ_IN.TXT',STATUS='OLD',ERR=940)
C
C     OUTPUT FILE ON UNIT 45 CONTAINS GQ TRIP PRODUCTIONS IN TEN
C     CATEGORIES
C
      OPEN (UNIT=45,FILE='PRODS_GQ_OUT.TXT',STATUS='NEW',ERR=945)
C
C     START LOOPING, READ A TG SUBZONE RECORD FROM INPUT FILES
C
      WRITE (*,'(/A/)') ' START OF BIG TG SUBZONE LOOP'

      COUNT = 0
C
   11 CONTINUE

      COUNT = COUNT + 1
C   
      DO I=1,33
        DO J=1,4    
          PRODS(I,J) = 0.0
        ENDDO
      ENDDO  
C
C     READ WORKERS AND NONWORKERS
C
      READ (40,*,END=999) SZ, GQ_MIL, GQ_UNIV, GQ_O18_64, GQ_O65
C
C     CHECK CONSISTENCY OF INPUT FILE
C
      IF (SZ .NE. COUNT) GO TO 946 
	IF (SZ .GT. SUBZONES) GO TO 946
C
C     GEOGRAPHY
C
      ICO = 0
	IICO = SZ_CO(SZ)
	DO J=1,COUNTIES
        IF (IICO .EQ. CO_NUM(J)) ICO = J
      ENDDO

	IP1 = 0
	IIP1 = SZ_PUMA1(SZ)
	DO J=1,PUMA1
	  IF (IIP1 .EQ. P1_NUM(J)) IP1 = J
	ENDDO
	  
	IP5 = 0
	IIP5 = SZ_PUMA5(SZ)
	DO J=1,PUMA5
	  IF (IIP5 .EQ. P5_NUM(J)) IP5 = J
      ENDDO
C       
      WRITE (*,'(A,I6)') ' TG SUBZONE= ', SZ
C
C     ACCUMULATE GROUP QUARTERS TOTALS
C
      CO_GQ_WORKER(ICO) = CO_GQ_WORKER(ICO) + 
     A  GQ_MIL + GQ_UNIV*0.879 + GQ_O18_64*0.495 + GQ_O65*0.183
      CO_GQ_NONW(ICO) = CO_GQ_NONW(ICO) +
     A  GQ_UNIV*(1.00-0.879) + GQ_O18_64*(1.00-0.495) + 
     B  GQ_O65*(1.00-0.183)

      PUMA1_GQ_WORKER(IP1) = PUMA1_GQ_WORKER(IP1) + 
     A  GQ_MIL + GQ_UNIV*0.879 + GQ_O18_64*0.495 + GQ_O65*0.183
      PUMA1_GQ_NONW(IP1) = PUMA1_GQ_NONW(IP1) +
     A  GQ_UNIV*(1.00-0.879) + GQ_O18_64*(1.00-0.495) + 
     B  GQ_O65*(1.00-0.183)

      PUMA5_GQ_WORKER(IP5) = PUMA5_GQ_WORKER(IP5) + 
     A  GQ_MIL + GQ_UNIV*0.879 + GQ_O18_64*0.495 + GQ_O65*0.183
      PUMA5_GQ_NONW(IP5) = PUMA5_GQ_NONW(IP5) +
     A  GQ_UNIV*(1.00-0.879) + GQ_O18_64*(1.00-0.495) + 
     B  GQ_O65*(1.00-0.183)

      TOT_GQ_WORKER = TOT_GQ_WORKER + 
     A  GQ_MIL + GQ_UNIV*0.879 + GQ_O18_64*0.495 + GQ_O65*0.183
      TOT_GQ_NONW = TOT_GQ_NONW +
     A  GQ_UNIV*(1.00-0.879) + GQ_O18_64*(1.00-0.495) + 
     B  GQ_O65*(1.00-0.183)

	IF(SZ_CHI(SZ) .EQ. 1) THEN
        CHI_GQ_WORKER = CHI_GQ_WORKER + 
     A  GQ_MIL + GQ_UNIV*0.879 + GQ_O18_64*0.495 + GQ_O65*0.183
	  CHI_GQ_NONW = CHI_GQ_NONW +
     A  GQ_UNIV*(1.00-0.879) + GQ_O18_64*(1.00-0.495) + 
     B  GQ_O65*(1.00-0.183)
	ENDIF	

      IF(SZ_CBD(SZ) .EQ. 1) THEN
        CBD_GQ_WORKER = CBD_GQ_WORKER + 
     A  GQ_MIL + GQ_UNIV*0.879 + GQ_O18_64*0.495 + GQ_O65*0.183
	  CBD_GQ_NONW = CBD_GQ_NONW +
     A  GQ_UNIV*(1.00-0.879) + GQ_O18_64*(1.00-0.495) + 
     B  GQ_O65*(1.00-0.183)
	ENDIF	
C
C     TRIP PRODUCTION CALCULATION (ONLY VEHICLE TRIPS)
C
C     THE TRIP RATES FOR GROUP QUARTERS ARE THE FOLLOWING.
C       THE WORK RATE WAS ESTIMATED FROM PUMS GROUP QUARTERS DATA.
C       GQW_H_WORKP IS THE HOME TO WORKPLACE PRODUCTION TRIP RATE FOR
C       GQ WORKERS.  GQ_FRAC IS THE FRACTION OF WORK TRIPS THAT ARE
C       BY MOTORIZED MODES.  ALL GQ WORKERS ARE ASSUMED TO BE IN THE
C       LESS THAN MEDIAN REGIONAL EARNINGS.CATEGORY.
C       
C     TRIP RATES FOR OTHER PURPOSES ARE ASSUMED TO EQUAL THOSE OF
C     A WORKER OR NONWORKER IN A SINGLE PERSON HH WITHOUT A VEHICLE
C     OR CHILDREN IN THE LOWEST INOME QUARTILE.
C
C     LOW INCOME HOME TO WORKPLACE (PRODS(1))
C       1.  FIRST FACTOR WORKERS PER GROUP QUARTERS PERSON
C       2.  SECOND FACTOR HOME-WORKPLACE PRODUCTIONS PER WORKER
C       3.  THIRD FACTOR IS FRACTION VEHICLE TRIPS
C
	PRODS(1,1) = PRODS(1,1) + GQ_MIL*1.95*0.141
      PRODS(1,2) = PRODS(1,2) + GQ_UNIV*0.879*0.90*0.152
      PRODS(1,3) = PRODS(1,3) + GQ_O18_64*0.495*1.10*0.295
      PRODS(1,4) = PRODS(1,4) + GQ_O65*0.183*1.10*0.262
C
C     HOME TO WORK RELATED (PRODS(3))
C
	PRODS(3,1) = PRODS(3,1) + GQ_MIL*0.1131*0.141
     	PRODS(3,2) = PRODS(3,2) + GQ_UNIV*0.879*0.1131*0.152
	PRODS(3,3) = PRODS(3,3) + GQ_O18_64*0.495*0.1131*0.295
	PRODS(3,4) = PRODS(3,4) + GQ_O65*0.183*0.1131*0.262
C
C     HOME TO SCHOOL (PRODS(4))
C
	PRODS(4,1) = 0.0
     	PRODS(4,2) = 0.0
     	PRODS(4,3) = PRODS(4,3) + GQ_O18_64*0.495*0.0160*0.295
	PRODS(4,4) = 0.0
C
C     HOME TO NONHOME/WORK, HOME (PRODS(5))
C
	PRODS(5,1) = PRODS(5,1) + GQ_MIL*0.1590*0.141
      PRODS(5,2) = PRODS(5,2) + GQ_UNIV*0.879*0.1590*0.152
      PRODS(5,3) = PRODS(5,3) + GQ_O18_64*0.495*0.1590*0.295
	PRODS(5,4) = PRODS(5,4) + GQ_O65*0.183*0.1590*0.262
C
C     HOME TO NONHOME/WORK, NONHOME (PRODS(6))
C
      PRODS(6,1) = PRODS(6,1) + GQ_MIL*0.6842*0.141
      PRODS(6,2) = PRODS(6,2) + GQ_UNIV*0.879*0.6842*0.152
      PRODS(6,3) = PRODS(6,3) + GQ_O18_64*0.495*0.6842*0.295
      PRODS(6,4) = PRODS(6,4) + GQ_O65*0.183*0.6842*0.262
C
C     HOME TO SHOP (PRODS(7))
C
	PRODS(7,1) = PRODS(7,1) + GQ_MIL*0.2949*0.141
      PRODS(7,2) = PRODS(7,2) + GQ_UNIV*0.879*0.2949*0.152
	PRODS(7,3) = PRODS(7,3) + GQ_O18_64*0.495*0.2949*0.295
	PRODS(7,4) = PRODS(7,4) + GQ_O65*0.183*0.2949*0.262
C
C     WORK TO NONHOME/WORK, HOME (PRODS(8))
C
	PRODS(8,1) = PRODS(8,1) + GQ_MIL*0.0320*0.141
      PRODS(8,2) = PRODS(8,2) + GQ_UNIV*0.879*0.0320*0.152
	PRODS(8,3) = PRODS(8,3) + GQ_O18_64*0.495*0.0320*0.295
	PRODS(8,4) = PRODS(8,4) + GQ_O65*0.183*0.0320*0.262
C
C     WORK TO NONHOME/WORK, NONHOME (PRODS(9))
C
	PRODS(9,1) = PRODS(9,1) + GQ_MIL*0.2725*0.141
     	PRODS(9,2) = PRODS(9,2) + GQ_UNIV*0.879*0.2725*0.152
	PRODS(9,3) = PRODS(9,3) + GQ_O18_64*0.495*0.2725*0.295
	PRODS(9,4) = PRODS(9,4) + GQ_O65*0.183*0.2725*0.262
C
C     WORK TO SHOP (PRODS(10))
C
	PRODS(10,1) = PRODS(10,1) + GQ_MIL*0.0815*0.141
      PRODS(10,2) = PRODS(10,2) + GQ_UNIV*0.879*0.0815*0.152
	PRODS(10,3) = PRODS(10,3) + GQ_O18_64*0.495*0.0815*0.295
	PRODS(10,4) = PRODS(10,4) + GQ_O65*0.183*0.0815*0.262
C
C     WORK TO WORK (PRODS(11))
C
      PRODS(11,1) = PRODS(11,1) + GQ_MIL*0.0718*0.141
      PRODS(11,2) = PRODS(11,2) + GQ_UNIV*0.879*0.0718*0.152
      PRODS(11,3) = PRODS(11,3) + GQ_O18_64*0.495*0.0718*0.295
      PRODS(11,4) = PRODS(11,4) + GQ_O65*0.183*0.0718*0.262
C
C     NONHOME/WORK, HOME TO NONHOME/WORK, HOME (PRODS(12))
C
	PRODS(12,1) = PRODS(12,1) + GQ_MIL*0.0068*0.141
      PRODS(12,2) = PRODS(12,2) + GQ_UNIV*0.879*0.0068*0.152
	PRODS(12,3) = PRODS(12,3) + GQ_O18_64*0.495*0.0068*0.295
	PRODS(12,4) = PRODS(12,4) + GQ_O65*0.183*0.0068*0.262
C
C     NONHOME/WORK, HOME TO NONHOME/WORK, NONHOME (PRODS(13))
C
	PRODS(13,1) = PRODS(13,1) + GQ_MIL*0.0220*0.141
      PRODS(13,2) = PRODS(13,2) + GQ_UNIV*0.879*0.0220*0.152
	PRODS(13,3) = PRODS(13,3) + GQ_O18_64*0.495*0.0220*0.295
	PRODS(13,4) = PRODS(13,4) + GQ_O65*0.183*0.0220*0.262
C
C     NONHOME/WORK, HOME TO SHOP (PRODS(14))
C
	PRODS(14,1) = PRODS(14,1) + GQ_MIL*0.0082*0.141
      PRODS(14,2) = PRODS(14,2) + GQ_UNIV*0.879*0.0082*0.152
	PRODS(14,3) = PRODS(14,3) + GQ_O18_64*0.495*0.0082*0.295
	PRODS(14,4) = PRODS(14,4) + GQ_O65*0.183*0.0082*0.262
C
C     NONHOME/WORK, NONHOME TO NONHOME/WORK, HOME (PRODS(15))
C
	PRODS(15,1) = PRODS(15,1) + GQ_MIL*0.0188*0.141
     	PRODS(15,2) = PRODS(15,2) + GQ_UNIV*0.879*0.0188*0.152
	PRODS(15,3) = PRODS(15,3) + GQ_O18_64*0.495*0.0188*0.295
	PRODS(15,4) = PRODS(15,4) + GQ_O65*0.183*0.0188*0.262
C
C     NONHOME/WORK, NONHOME TO NONHOME/WORK, NONHOME 
C     (PRODS(16))
C
	PRODS(16,1) = PRODS(16,1) + GQ_MIL*0.1747*0.141
      PRODS(16,2) = PRODS(16,2) + GQ_UNIV*0.879*0.1747*0.152
	PRODS(16,3) = PRODS(16,3) + GQ_O18_64*0.495*0.1747*0.295
	PRODS(16,4) = PRODS(16,4) + GQ_O65*0.183*0.1747*0.262
C
C     NONHOME/WORK, NONHOME TO SHOP (PRODS(17))
C
	PRODS(17,1) = PRODS(17,1) + GQ_MIL*0.0877*0.141
      PRODS(17,2) = PRODS(17,2) + GQ_UNIV*0.879*0.0877*0.152
	PRODS(17,3) = PRODS(17,3) + GQ_O18_64*0.495*0.0877*0.295
	PRODS(17,4) = PRODS(17,4) + GQ_O65*0.183*0.0877*0.262
C
C     SHOP TO NONHOME/WORK, HOME (PRODS(18))
C
	PRODS(18,1) = PRODS(18,1) + GQ_MIL*0.0121*0.141
      PRODS(18,2) = PRODS(18,2) + GQ_UNIV*0.879*0.0121*0.152
	PRODS(18,3) = PRODS(18,3) + GQ_O18_64*0.495*0.0121*0.295
	PRODS(18,4) = PRODS(18,4) + GQ_O65*0.183*0.0121*0.262
C
C     SHOP TO NONHOME/WORK, NONHOME (PRODS(19))
C
	PRODS(19,1) = PRODS(19,1) + GQ_MIL*0.0503*0.141
      PRODS(19,2) = PRODS(19,2) + GQ_UNIV*0.879*0.0503*0.152
	PRODS(19,3) = PRODS(19,3) + GQ_O18_64*0.495*0.0503*0.295
	PRODS(19,4) = PRODS(19,4) + GQ_O65*0.183*0.0503*0.262
C
C     SHOP TO SHOP (PRODS(20))
C
      PRODS(20,1) = PRODS(20,1) + GQ_MIL*0.0438*0.141
      PRODS(20,2) = PRODS(20,2) + GQ_UNIV*0.879*0.0438*0.152
      PRODS(20,3) = PRODS(20,3) + GQ_O18_64*0.495*0.0438*0.295
      PRODS(20,4) = PRODS(20,4) + GQ_O65*0.183*0.0438*0.262
C
C     NEXT NONWORKERS (PRODS(21-33))
C
C     HOME TO SCHOOL (PRODS(21))
C
	PRODS(21,1) = 0.0
      PRODS(21,2) = 0.0
	PRODS(21,3) = PRODS(21,3) + GQ_O18_64*(1.00-0.495)*0.0342*0.295
	PRODS(21,4) = 0.0
C
C     HOME TO NONHOME, HOME (PRODS(22))
C
	PRODS(22,1) = 0.0
      PRODS(22,2) = PRODS(22,2) + GQ_UNIV*(1.00-0.879)*0.1475*0.152
	PRODS(22,3) = PRODS(22,3) + GQ_O18_64*(1.00-0.495)*0.1475*0.295
	PRODS(22,4) = PRODS(22,4) + GQ_O65*(1.00-0.183)*0.1475*0.262
C      
C     HOME TO NONHOME, NONHOME (PRODS(23))
C
      PRODS(23,1) = 0.0
      PRODS(23,2) = PRODS(23,2) + GQ_UNIV*(1.00-0.879)*0.8842*0.152
      PRODS(23,3) = PRODS(23,3) + GQ_O18_64*(1.00-0.495)*0.8842*0.295
      PRODS(23,4) = PRODS(23,4) + GQ_O65*(1.00-0.183)*0.8842*0.262
C
C     HOME TO SHOP (PRODS(24))
C
	PRODS(24,1) = 0.0
      PRODS(24,2) = PRODS(24,2) + GQ_UNIV*(1.00-0.879)*0.5060*0.152
	PRODS(24,3) = PRODS(24,3) + GQ_O18_64*(1.00-0.495)*0.5060*0.295
	PRODS(24,4) = PRODS(24,4) + GQ_O65*(1.00-0.183)*0.5060*0.262
C
C     NONHOME, HOME TO NONHOME, HOME (PRODS(25))
C
	PRODS(25,1) = 0.0
     	PRODS(25,2) = PRODS(25,2) + GQ_UNIV*(1.00-0.879)*0.0131*0.152
	PRODS(25,3) = PRODS(25,3) + GQ_O18_64*(1.00-0.495)*0.0131*0.295
	PRODS(25,4) = PRODS(25,4) + GQ_O65*(1.00-0.183)*0.0131*0.262
C
C     NONHOME, HOME TO NONHOME, NONHOME (PRODS(26))
C
	PRODS(26,1) = 0.0
      PRODS(26,2) = PRODS(26,2) + GQ_UNIV*(1.00-0.879)*0.0175*0.152
	PRODS(26,3) = PRODS(26,3) + GQ_O18_64*(1.00-0.495)*0.0175*0.295
	PRODS(26,4) = PRODS(26,4) + GQ_O65*(1.00-0.183)*0.0175*0.262
C
C     NONHOME, HOME TO SHOP (PRODS(27))
C
	PRODS(27,1) = 0.0
      PRODS(27,2) = PRODS(27,2) + GQ_UNIV*(1.00-0.879)*0.0099*0.152
	PRODS(27,3) = PRODS(27,3) + GQ_O18_64*(1.00-0.495)*0.0099*0.295
	PRODS(27,4) = PRODS(27,4) + GQ_O65*(1.00-0.183)*0.0099*0.262
C
C     NONHOME, NONHOME TO NONHOME, HOME (PRODS(28))
C
	PRODS(28,1) = 0.0
      PRODS(28,2) = PRODS(28,2) + GQ_UNIV*(1.00-0.879)*0.0263*0.152
	PRODS(28,3) = PRODS(28,3) + GQ_O18_64*(1.00-0.495)*0.0263*0.295
	PRODS(28,4) = PRODS(28,4) + GQ_O65*(1.00-0.183)*0.0263*0.262
C
C     NONHOME, NONHOME TO NONHOME, NONHOME 
C     (PRODS(29))
C
	PRODS(29,1) = 0.0
     	PRODS(29,2) = PRODS(29,2) + GQ_UNIV*(1.00-0.879)*0.1121*0.152
	PRODS(29,3) = PRODS(29,3) + GQ_O18_64*(1.00-0.495)*0.1121*0.295
	PRODS(29,4) = PRODS(29,4) + GQ_O65*(1.00-0.183)*0.1121*0.262
C
C     NONHOME, NONHOME TO SHOP (PRODS(30))
C
	PRODS(30,1) = 0.0
      PRODS(30,2) = PRODS(30,2) + GQ_UNIV*(1.00-0.879)*0.0943*0.152
	PRODS(30,3) = PRODS(30,3) + GQ_O18_64*(1.00-0.495)*0.0943*0.295
	PRODS(30,4) = PRODS(30,4) + GQ_O65*(1.00-0.183)*0.0943*0.262
C
C     SHOP TO NONHOME, HOME (PRODS(31))
C
	PRODS(31,1) = 0.0
      PRODS(31,2) = PRODS(31,2) + GQ_UNIV*(1.00-0.879)*0.0137*0.152
	PRODS(31,3) = PRODS(31,3) + GQ_O18_64*(1.00-0.495)*0.0137*0.295
	PRODS(31,4) = PRODS(31,4) + GQ_O65*(1.00-0.183)*0.0137*0.262
C
C     SHOP TO NONHOME, NONHOME (PRODS(32))
C
	PRODS(32,1) = 0.0
      PRODS(32,2) = PRODS(32,2) + GQ_UNIV*(1.00-0.879)*0.0591*0.152
	PRODS(32,3) = PRODS(32,3) + GQ_O18_64*(1.00-0.495)*0.0591*0.295
	PRODS(32,4) = PRODS(32,4) + GQ_O65*(1.00-0.183)*0.0591*0.262
C
C     SHOP TO SHOP (PRODS(33))
C
      PRODS(33,1) = 0.0
      PRODS(33,2) = PRODS(33,2) + GQ_UNIV*(1.00-0.879)*0.0967*0.152
      PRODS(33,3) = PRODS(33,3) + GQ_O18_64*(1.00-0.495)*0.0967*0.295
      PRODS(33,4) = PRODS(33,4) + GQ_O65*(1.00-0.183)*0.0967*0.262
C
C     WRITE OUT PRODUCTIONS FILE FOR TG SUBZONE
C
      WRITE (45,'(I6,132F12.4)') SZ,
     A (PRODS(I,1),PRODS(I,2),PRODS(I,3),PRODS(I,4),I=1,33)
C
C     ACCUMULATE SUMMARIES ACCROSS ALL GQ TYPES
C
      DO I=1,4
C
C     COUNTY TOTALS ORIGINAL TRIP TYPES
C
	  CO_GQ_PRODS1(ICO,1) = CO_GQ_PRODS1(ICO,1) + PRODS(1,I) + 
     A    PRODS(3,I) + PRODS(4,I) 

	  CO_GQ_PRODS1(ICO,2) = CO_GQ_PRODS1(ICO,2) + PRODS(7,I)

	  CO_GQ_PRODS1(ICO,3) = CO_GQ_PRODS1(ICO,3) + PRODS(5,I) + 
     A    PRODS(6,I)

	  CO_GQ_PRODS1(ICO,4) = CO_GQ_PRODS1(ICO,4) + PRODS(10,I)

	  CO_GQ_PRODS1(ICO,5) = CO_GQ_PRODS1(ICO,5) + PRODS(8,I) + 
     A    PRODS(9,I)

	  CO_GQ_PRODS1(ICO,6) = CO_GQ_PRODS1(ICO,6) + PRODS(11,I)

	  CO_GQ_PRODS1(ICO,7) = CO_GQ_PRODS1(ICO,7) + PRODS(12,I) + 
     A    PRODS(13,I) + PRODS(14,I) + PRODS(15,I) + PRODS(16,I) + 
     B    PRODS(17,I) + PRODS(18,I) + PRODS(19,I) + PRODS(20,I)

	  CO_GQ_PRODS1(ICO,8) = CO_GQ_PRODS1(ICO,8) + PRODS(24,I)

	  CO_GQ_PRODS1(ICO,9) = CO_GQ_PRODS1(ICO,9) + PRODS(21,I) + 
     A    PRODS(22,I) + PRODS(23,I)

	  CO_GQ_PRODS1(ICO,10) = CO_GQ_PRODS1(ICO,10) + PRODS(25,I) + 
     A    PRODS(26,I) + PRODS(27,I) + PRODS(28,I) + PRODS(29,I) + 
     B    PRODS(30,I) + PRODS(31,I) + PRODS(32,I) + PRODS(33,I)
C
C     CHICAGO AND CBD SUMMARIES
C
        IF (SZ_CHI(SZ) .EQ. 1) THEN 
	    CHI_GQ_PRODS1(1) = CHI_GQ_PRODS1(1) + PRODS(1,I) +
     A    PRODS(3,I) + PRODS(4,I)

	    CHI_GQ_PRODS1(2) = CHI_GQ_PRODS1(2) + PRODS(7,I)

	    CHI_GQ_PRODS1(3) = CHI_GQ_PRODS1(3) + PRODS(5,I) + 
     A      PRODS(6,I)

	    CHI_GQ_PRODS1(4) = CHI_GQ_PRODS1(4) + PRODS(10,I)

	    CHI_GQ_PRODS1(5) = CHI_GQ_PRODS1(5) + PRODS(8,I) + 
     A      PRODS(9,I)

	    CHI_GQ_PRODS1(6) = CHI_GQ_PRODS1(6) + PRODS(11,I)

	    CHI_GQ_PRODS1(7) = CHI_GQ_PRODS1(7) + PRODS(12,I) + 
     A      PRODS(13,I) + PRODS(14,I) + PRODS(15,I) + PRODS(16,I) + 
     B      PRODS(17,I) + PRODS(18,I) + PRODS(19,I) + PRODS(20,I)

	    CHI_GQ_PRODS1(8) = CHI_GQ_PRODS1(8) + PRODS(24,I)

	    CHI_GQ_PRODS1(9) = CHI_GQ_PRODS1(9) + PRODS(21,I) + 
     A      PRODS(22,I) + PRODS(23,I)

	    CHI_GQ_PRODS1(10) = CHI_GQ_PRODS1(10) + PRODS(25,I) + 
     A      PRODS(26,I) + PRODS(27,I) + PRODS(28,I) + PRODS(29,I) + 
     B      PRODS(30,I) + PRODS(31,I) + PRODS(32,I) + PRODS(33,I)

        ENDIF  
C
        IF (SZ_CBD(SZ) .EQ. 1) THEN
	    CBD_GQ_PRODS1(1) = CBD_GQ_PRODS1(1) + PRODS(1,I) + 
     A      PRODS(3,I) + PRODS(4,I)

	    CBD_GQ_PRODS1(2) = CBD_GQ_PRODS1(2) + PRODS(7,I)

	    CBD_GQ_PRODS1(3) = CBD_GQ_PRODS1(3) + PRODS(5,I) + PRODS(6,I)

	    CBD_GQ_PRODS1(4) = CBD_GQ_PRODS1(4) + PRODS(10,I)

	    CBD_GQ_PRODS1(5) = CBD_GQ_PRODS1(5) + PRODS(8,I) + PRODS(9,I)

	    CBD_GQ_PRODS1(6) = CBD_GQ_PRODS1(6) + PRODS(11,I)

	    CBD_GQ_PRODS1(7) = CBD_GQ_PRODS1(7) + PRODS(12,I) + 
     A      PRODS(13,I) + PRODS(14,I) + PRODS(15,I) + PRODS(16,I) + 
     B      PRODS(17,I) + PRODS(18,I) + PRODS(19,I) + PRODS(20,I)

	    CBD_GQ_PRODS1(8) = CBD_GQ_PRODS1(8) + PRODS(24,I)

	    CBD_GQ_PRODS1(9) = CBD_GQ_PRODS1(9) + PRODS(21,I) + 
     A      PRODS(22,I) + PRODS(23,I)

	    CBD_GQ_PRODS1(10) = CBD_GQ_PRODS1(10) + PRODS(25,I) + 
     A      PRODS(26,I) + PRODS(27,I) + PRODS(28,I) + PRODS(29,I) + 
     B      PRODS(30,I) + PRODS(31,I) + PRODS(32,I) + PRODS(33,I)
        ENDIF  
C
C     PUMA1 TOTALS ORIGINAL TRIP TYPES
C
	  PUMA1_GQ_PRODS1(IP1,1) = PUMA1_GQ_PRODS1(IP1,1) + PRODS(1,I) + 
     A    PRODS(3,I) + PRODS(4,I)

	  PUMA1_GQ_PRODS1(IP1,2) = PUMA1_GQ_PRODS1(IP1,2) + PRODS(7,I)

	  PUMA1_GQ_PRODS1(IP1,3) = PUMA1_GQ_PRODS1(IP1,3) + PRODS(5,I) + 
     A    PRODS(6,I)

	  PUMA1_GQ_PRODS1(IP1,4) = PUMA1_GQ_PRODS1(IP1,4) + PRODS(10,I)

	  PUMA1_GQ_PRODS1(IP1,5) = PUMA1_GQ_PRODS1(IP1,5) + PRODS(8,I) + 
     A    PRODS(9,I)

	  PUMA1_GQ_PRODS1(IP1,6) = PUMA1_GQ_PRODS1(IP1,6) + PRODS(11,I)

	  PUMA1_GQ_PRODS1(IP1,7) = PUMA1_GQ_PRODS1(IP1,7) + PRODS(12,I) + 
     A  PRODS(13,I) + PRODS(14,I) + PRODS(15,I) + PRODS(16,I) + 
     B  PRODS(17,I) + PRODS(18,I) + PRODS(19,I) + PRODS(20,I)

	  PUMA1_GQ_PRODS1(IP1,8) = PUMA1_GQ_PRODS1(IP1,8) + PRODS(24,I)

	  PUMA1_GQ_PRODS1(IP1,9) = PUMA1_GQ_PRODS1(IP1,9) + PRODS(21,I) + 
     A    PRODS(22,I) + PRODS(23,I)

	  PUMA1_GQ_PRODS1(IP1,10) = PUMA1_GQ_PRODS1(IP1,10) + 
     A    PRODS(25,I) + PRODS(26,I) + PRODS(27,I) + PRODS(28,I) + 
     B    PRODS(29,I) + PRODS(30,I) + PRODS(31,I) + PRODS(32,I) + 
     C    PRODS(33,I)
C
C     PUMA5 TOTALS ORIGINAL TRIP TYPES
C
	  PUMA5_GQ_PRODS1(IP5,1) = PUMA5_GQ_PRODS1(IP5,1) + PRODS(1,I) + 
     A    PRODS(3,I) + PRODS(4,I)

	  PUMA5_GQ_PRODS1(IP5,2) = PUMA5_GQ_PRODS1(IP5,2) + PRODS(7,I)

	  PUMA5_GQ_PRODS1(IP5,3) = PUMA5_GQ_PRODS1(IP5,3) + PRODS(5,I) + 
     A    PRODS(6,I)

	  PUMA5_GQ_PRODS1(IP5,4) = PUMA5_GQ_PRODS1(IP5,4) + PRODS(10,I)

	  PUMA5_GQ_PRODS1(IP5,5) = PUMA5_GQ_PRODS1(IP5,5) + PRODS(8,I) + 
     A    PRODS(9,I)

	  PUMA5_GQ_PRODS1(IP5,6) = PUMA5_GQ_PRODS1(IP5,6) + PRODS(11,I)

	  PUMA5_GQ_PRODS1(IP5,7) = PUMA5_GQ_PRODS1(IP5,7) + PRODS(12,I) + 
     A    PRODS(13,I) + PRODS(14,I) + PRODS(15,I) + PRODS(16,I) + 
     B    PRODS(17,I) + PRODS(18,I) + PRODS(19,I) + PRODS(20,I)

	  PUMA5_GQ_PRODS1(IP5,8) = PUMA5_GQ_PRODS1(IP5,8) + PRODS(24,I)

	  PUMA5_GQ_PRODS1(IP5,9) = PUMA5_GQ_PRODS1(IP5,9) + PRODS(21,I) + 
     A    PRODS(22,I) + PRODS(23,I)

	  PUMA5_GQ_PRODS1(IP5,10) = PUMA5_GQ_PRODS1(IP5,10) + PRODS(25,I) + 
     A    PRODS(26,I) + PRODS(27,I) + PRODS(28,I) + PRODS(29,I) + 
     B    PRODS(30,I) + PRODS(31,I) + PRODS(32,I) + PRODS(33,I)
C
C     REGIONAL TOTALS ORIGINAL TRIP TYPES
C
	  TOT_GQ_PRODS1(1) = TOT_GQ_PRODS1(1) + PRODS(1,I) + PRODS(3,I) + 
     A    PRODS(4,I)

	  TOT_GQ_PRODS1(2) = TOT_GQ_PRODS1(2) + PRODS(7,I)

	  TOT_GQ_PRODS1(3) = TOT_GQ_PRODS1(3) + PRODS(5,I) + PRODS(6,I)

	  TOT_GQ_PRODS1(4) = TOT_GQ_PRODS1(4) + PRODS(10,I)

	  TOT_GQ_PRODS1(5) = TOT_GQ_PRODS1(5) + PRODS(8,I) + PRODS(9,I)

	  TOT_GQ_PRODS1(6) = TOT_GQ_PRODS1(6) + PRODS(11,I)

	  TOT_GQ_PRODS1(7) = TOT_GQ_PRODS1(7) + PRODS(12,I) + 
     A    PRODS(13,I) + PRODS(14,I) + PRODS(15,I) + PRODS(16,I) + 
     B    PRODS(17,I) + PRODS(18,I) + PRODS(19,I) + PRODS(20,I)

	  TOT_GQ_PRODS1(8) = TOT_GQ_PRODS1(8) + PRODS(24,I)

	  TOT_GQ_PRODS1(9) = TOT_GQ_PRODS1(9) + PRODS(21,I) + 
     A    PRODS(22,I) + PRODS(23,I)

	  TOT_GQ_PRODS1(10) = TOT_GQ_PRODS1(10) + PRODS(25,I) +
     A    PRODS(26,I) + PRODS(27,I) + PRODS(28,I) + PRODS(29,I) +
     B    PRODS(30,I) + PRODS(31,I) + PRODS(32,I) + PRODS(33,I)
      ENDDO  
C
C     NOW REPEAT FOR NEW TRIP CATEGORIES
C
      DO I=1,4
        DO ITRP=1,33

          CO_GQ_PRODS2(ICO,ITRP) = CO_GQ_PRODS2(ICO,ITRP) +
     A      PRODS(ITRP,I)

          IF (SZ_CHI(SZ) .EQ. 1) CHI_GQ_PRODS2(ITRP) = 
     A      CHI_GQ_PRODS2(ITRP) + PRODS(ITRP,I)

          IF (SZ_CBD(SZ) .EQ. 1) CBD_GQ_PRODS2(ITRP) = 
     A      CBD_GQ_PRODS2(ITRP) + PRODS(ITRP,I)

          PUMA1_GQ_PRODS2(IP1,ITRP) = PUMA1_GQ_PRODS2(IP1,ITRP) + 
     A      PRODS(ITRP,I)

          PUMA5_GQ_PRODS2(IP5,ITRP) = PUMA5_GQ_PRODS2(IP5,ITRP) + 
     A      PRODS(ITRP,I)

          TOT_GQ_PRODS2(ITRP) = TOT_GQ_PRODS2(ITRP) + PRODS(ITRP,I)

        ENDDO
      ENDDO  
C
C     RETURN FOR ANOTHER TG SUBZONE
C
      GO TO 11
C
  940 WRITE (*,'(/A)')  'ERROR:  PROBLEM OPENING FILE GQ_IN.TXT'
      STOP 940
  945 WRITE (*,'(/A)')  'ERROR:  PROBLEM OPENING FILE PRODS_GQ_OUT.TXT'
      STOP 945
  946 WRITE (*,'(/A)')  'ERROR:  PROBLEM WITH SUBZONE SEQUENCE IN FILE G
     AQ_IN.TXT'
      STOP 946
C
  999 CONTINUE
C
C     PRINT ROW AND COLUMN TOTALS FOR CHECKING
C
	WRITE(16,'(/A)')   'GROUP QUARTERS TOTALS'
	WRITE (16,'(/A)')  'COUNTIES'
	WRITE (16,'(/A)')  '                  NON'
	WRITE (16,'(A)')   ' COUNTY  WORKERS  WORKERS'
	WRITE (16,'(A)')   '-------------------------'       
	
	DO I=1,COUNTIES
	  WRITE (16,'(I7,2F9.0)') 
     A    CO_NUM(I), CO_GQ_WORKER(I), CO_GQ_NONW(I)
	ENDDO

	WRITE(16,'(A,2F9.0)')   '  TOTAL', TOT_GQ_WORKER, TOT_GQ_NONW
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_WORKER, CHI_GQ_NONW  
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_WORKER, CBD_GQ_NONW

C
	WRITE (16,'(/A)')  'ONE PERCENT PUMAS'
	WRITE (16,'(/A)')  '                  NON'
	WRITE (16,'(A)')   '  PUMA1  WORKERS  WORKERS'
	WRITE (16,'(A)')   '-------------------------'       
	
	DO I=1,PUMA1
	  WRITE (16,'(I7,2F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I), 
     A    PUMA1_GQ_NONW(I) 
	ENDDO

	WRITE(16,'(A,2F9.0)')   '  TOTAL', TOT_GQ_WORKER, TOT_GQ_NONW
C
	WRITE (16,'(/A)')  'FIVE PERCENT PUMAS'
	WRITE (16,'(/A)')  '                         NON'
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS  WORKERS'
	WRITE (16,'(A)')   '--------------------------------'       
	
	DO I=1,PUMA5
	  WRITE (16,'(2I7,2F9.0)') P5_NUM(I), P5_PUMA1(I), 
     A    PUMA5_GQ_WORKER(I), PUMA5_GQ_NONW(I) 
	ENDDO

	WRITE(16,'(A,2F9.0)')   '  TOTAL       ', TOT_GQ_WORKER, 
     A  TOT_GQ_NONW
C
C     IF EXP_TYPE IS TRUE ONLY PRINT OUT EXPANDED SUMMARIES
C
      IF (EXP_TTYPE) GO TO 1001
C
C     SUMMARIES USING ORIGINAL TRIP CATEGORIES
C
	WRITE(16,'(/A)')   'GROUP QUARTERS MOTORIZED TRIP PRODUCTIONS'
	WRITE (16,'(/A)')  'COUNTIES'
	WRITE(16,'(/A)')   'GROUP QUARTERS WORKERS'
	
	WRITE (16,'(A)')   ' COUNTY  WORKERS    HWORK    HSHOP    HOTHR   
     A WSHOP    WOTHR    WWORK    OTHER'
	WRITE (16,'(A)')   '----------------------------------------------
     A---------------------------------'       
	
	DO I=1,COUNTIES
	  WRITE (16,'(I7,8F9.0)') CO_NUM(I), CO_GQ_WORKER(I), 
     A    (CO_GQ_PRODS1(I,J),J=1,7)  
	ENDDO

	WRITE (16,'(A,8F9.0)')  '  TOTAL', TOT_GQ_WORKER, 
     A  (TOT_GQ_PRODS1(J), J=1,7)
      WRITE (16,'(/A,8F9.0)') 'CHICAGO', CHI_GQ_WORKER, 
     A  (CHI_GQ_PRODS1(J), J=1,7)
	WRITE (16,'(A,8F9.0)')  'CHI CBD', CBD_GQ_WORKER, 
     A  (CBD_GQ_PRODS1(J), J=1,7)
C
	WRITE(16,'(/A)')  'GROUP QUARTERS NONWORKERS'

	WRITE (16,'(A)')  ' COUNTY NONWORKS    HSHOP    HOTHR    OTHER'
	WRITE (16,'(A)')  '-------------------------------------------'
	      
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_NONW(I),
     A    (CO_GQ_PRODS1(I,J),J=8,10)  
	ENDDO

	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW, 
     A  (TOT_GQ_PRODS1(J), J=8,10)
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_NONW, 
     A  (CHI_GQ_PRODS1(J), J=8,10)
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_NONW, 
     A  (CBD_GQ_PRODS1(J), J=8,10)
C
C     REPEAT FOR ONE PERCENT PUMS
C
	WRITE (16,'(/A)')  'ONE PERCENT PUMAS'
	WRITE(16,'(/A)')   'GROUP QUARTERS WORKERS'
	
	WRITE (16,'(A)')   '  PUMA1  WORKERS    HWORK    HSHOP    HOTHR   
     A WSHOP    WOTHR    WWORK    OTHER'
	WRITE (16,'(A)')   '----------------------------------------------
     A---------------------------------'    
	
	DO I=1,PUMA1
	  WRITE (16,'(I7,8F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I),  
     A    (PUMA1_GQ_PRODS1(I,J),J=1,7)  
	ENDDO

	WRITE (16,'(A,8F9.0)')  '  TOTAL', TOT_GQ_WORKER, 
     A  (TOT_GQ_PRODS1(J), J=1,7)
C
	WRITE(16,'(/A)')  'GROUP QUARTERS NONWORKERS'

	WRITE (16,'(A)')  '  PUMA1 NONWORKS    HSHOP    HOTHR    OTHER'
	WRITE (16,'(A)')  '-------------------------------------------'
	      
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_NONW(I), 
     A    (PUMA1_GQ_PRODS1(I,J),J=8,10)  
	ENDDO

	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW, 
     A  (TOT_GQ_PRODS1(J), J=8,10)
C
C     REPEAT FOR FIVE PERCENT PUMS
C
	WRITE (16,'(/A)')  'FIVE PERCENT PUMAS'
	WRITE(16,'(/A)')   'GROUP QUARTERS WORKERS'
	
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS    HWORK    HSHOP    H
     AOTHR  WSHOP    WOTHR    WWORK    OTHER'
	WRITE (16,'(A)')   '----------------------------------------------
     A--------------------------------------'           
	
	DO I=1,PUMA5
	  WRITE (16,'(2I7,8F9.0)') P5_NUM(I), P5_PUMA1(I), 
     A    PUMA5_GQ_WORKER(I), (PUMA5_GQ_PRODS1(I,J),J=1,7)  
	ENDDO

	WRITE (16,'(A,8F9.0)')  '  TOTAL       ', TOT_GQ_WORKER, 
     A  (TOT_GQ_PRODS1(J), J=1,7)
C
	WRITE(16,'(/A)')  'GROUP QUARTERS NONWORKERS'

	WRITE (16,'(A)')  '  PUMA5  PUMA1 NONWORKS    HSHOP    HOTHR    OT
     AHER'
	WRITE (16,'(A)')  '-----------------------------------------------
     A---'
	      
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I), 
     A    PUMA5_GQ_NONW(I), (PUMA5_GQ_PRODS1(I,J),J=8,10)  
	ENDDO

	WRITE (16,'(A,4F9.0)') '  TOTAL       ', TOT_GQ_NONW, 
     A  (TOT_GQ_PRODS1(J), J=8,10)
C
      GO TO 1002
C***********************************************************************
C
C     SUMMARIES USING EXPANDED TRIP CATEGORIES
C
C***********************************************************************
 1001 CONTINUE
C
	WRITE(16,'(/A)') 'GROUP QUARTERS MOTORIZED EXPANDED TRIP PRODUCTIO
     ANS'
C***********************************************************************
	WRITE (16,'(/A)')  'COUNTIES'

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED HOME PRODUCTIO
     ANS'
	WRITE (16,'(A)')   ' COUNTY  WORKERS WKPL(<$) WKPL(>$) WORK REL   
     ASCHOOL  NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A---------------------------------'       
	DO I=1,COUNTIES
	  WRITE (16,'(I7,8F9.0)') CO_NUM(I), CO_GQ_WORKER(I),
     A    (CO_GQ_PRODS2(I,J),J=1,7)
     	ENDDO
	
	WRITE (16,'(A,8F9.0)')  '  TOTAL', TOT_GQ_WORKER, 
     A  (TOT_GQ_PRODS2(J),J=1,7) 
	WRITE (16,'(/A,8F9.0)') 'CHICAGO', CHI_GQ_WORKER, 
     A  (CHI_GQ_PRODS2(J),J=1,7) 
	WRITE (16,'(A,8F9.0)')  'CHI CBD', CBD_GQ_WORKER,
     A  (CBD_GQ_PRODS2(J),J=1,7) 

	WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED WORK PRODUCTIO
     ANS'
	WRITE (16,'(A)')   ' COUNTY  WORKERS  NH/W(H) NH/W(NH)     SHOP   
     A  WORK'   
	WRITE (16,'(A)')   '----------------------------------------------
     A------'       
	DO I=1,COUNTIES
	  WRITE (16,'(I7,5F9.0)') CO_NUM(I), CO_GQ_WORKER(I), 
     A    (CO_GQ_PRODS2(I,J),J=8,11)  
	ENDDO

	WRITE (16,'(A,5F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=8,11) 
	WRITE (16,'(/A,5F9.0)') 'CHICAGO', CHI_GQ_WORKER, 
     A  (CHI_GQ_PRODS2(J),J=8,11) 
	WRITE (16,'(A,5F9.0)')  'CHI CBD', CBD_GQ_WORKER,
     A  (CBD_GQ_PRODS2(J),J=8,11) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED NONHOME/WORK O
     ARIGINS AT HOUSEHOLDS'
	WRITE (16,'(A)')   ' COUNTY  WORKERS NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_WORKER(I), 
     A    (CO_GQ_PRODS2(I,J),J=12,14)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=12,14) 
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_WORKER,
     A  (CHI_GQ_PRODS2(J),J=12,14) 
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_WORKER,
     A  (CBD_GQ_PRODS2(J),J=12,14) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED NONHOME/WORK O
     ARIGINS NOT AT HOUSEHOLDS'
	WRITE (16,'(A)')   ' COUNTY  WORKERS NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_WORKER(I), 
     A    (CO_GQ_PRODS2(I,J),J=15,17)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=15,17) 
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_WORKER,
     A  (CHI_GQ_PRODS2(J),J=15,17) 
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_WORKER,
     A  (CBD_GQ_PRODS2(J),J=15,17) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED SHOP ORIGINS'
	WRITE (16,'(A)')   ' COUNTY  WORKERS NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'       
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_WORKER(I), 
     A    (CO_GQ_PRODS2(I,J),J=18,20)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=18,20) 
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_WORKER,
     A  (CHI_GQ_PRODS2(J),J=18,20) 
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_WORKER,
     A  (CBD_GQ_PRODS2(J),J=18,20) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED HOME PRODUC
     ATIONS'
	WRITE (16,'(A)')   ' COUNTY NONWORKS   SCHOOL    NH(H)   NH(NH)   
     A  SHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A------'       
	DO I=1,COUNTIES
	  WRITE (16,'(I7,5F9.0)') CO_NUM(I), CO_GQ_NONW(I),
     A    (CO_GQ_PRODS2(I,J),J=21,24)  
	ENDDO
	
	WRITE (16,'(A,5F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=21,24) 
	WRITE (16,'(/A,5F9.0)') 'CHICAGO', CHI_GQ_NONW,
     A  (CHI_GQ_PRODS2(J),J=21,24) 
	WRITE (16,'(A,5F9.0)')  'CHI CBD', CBD_GQ_NONW,
     A  (CBD_GQ_PRODS2(J),J=21,24) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED NONHOME ORI
     AGINS AT HOUSEHOLDS'
	WRITE (16,'(A)')   ' COUNTY NONWORKS   NH(H)   NH(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_NONW(I),
     A    (CO_GQ_PRODS2(I,J),J=25,27)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=25,27) 
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_NONW,
     A  (CHI_GQ_PRODS2(J),J=25,27) 
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_NONW,
     A  (CBD_GQ_PRODS2(J),J=25,27) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED NONHOME ORI
     AGINS NOT AT HOUSEHOLDS'
	WRITE (16,'(A)')   ' COUNTY NONWORKS   NH(H)   NH(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_NONW(I),
     A    (CO_GQ_PRODS2(I,J),J=28,30)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=28,30) 
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_NONW,
     A  (CHI_GQ_PRODS2(J),J=28,30) 
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_NONW,
     A  (CBD_GQ_PRODS2(J),J=28,30) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED SHOP ORIGIN
     AS'
	WRITE (16,'(A)')   ' COUNTY NONWORKS   NH(H)   NH(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,COUNTIES
	  WRITE (16,'(I7,4F9.0)') CO_NUM(I), CO_GQ_NONW(I),
     A    (CO_GQ_PRODS2(I,J),J=31,33)  
	ENDDO
		
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=31,33) 
	WRITE (16,'(/A,4F9.0)') 'CHICAGO', CHI_GQ_NONW,
     A  (CHI_GQ_PRODS2(J),J=31,33) 
	WRITE (16,'(A,4F9.0)')  'CHI CBD', CBD_GQ_NONW,
     A  (CBD_GQ_PRODS2(J),J=31,33) 
C***********************************************************************
	WRITE (16,'(/A)')  'ONE PERCENT PUMAS'

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED HOME PRODUCTIO
     ANS'
	WRITE (16,'(A)')   '  PUMA1  WORKERS WKPL(<$) WKPL(>$) WORK REL   
     ASCHOOL  NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A---------------------------------'       
	DO I=1,PUMA1
	  WRITE (16,'(I7,8F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I),
     A    (PUMA1_GQ_PRODS2(I,J),J=1,7)
     	ENDDO
	
	WRITE (16,'(A,8F9.0)')  '  TOTAL', TOT_GQ_WORKER, 
     A  (TOT_GQ_PRODS2(J),J=1,7) 

	WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED WORK PRODUCTIO
     ANS'
	WRITE (16,'(A)')   '  PUMA1  WORKERS  NH/W(H) NH/W(NH)     SHOP   
     A  WORK'   
	WRITE (16,'(A)')   '----------------------------------------------
     A------'       
	DO I=1,PUMA1
	  WRITE (16,'(I7,5F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I), 
     A    (PUMA1_GQ_PRODS2(I,J),J=8,11)  
	ENDDO

	WRITE (16,'(A,5F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=8,11) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED NONHOME/WORK O
     ARIGINS AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA1  WORKERS NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I), 
     A    (PUMA1_GQ_PRODS2(I,J),J=12,14)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=12,14) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED NONHOME/WORK O
     ARIGINS NOT AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA1  WORKERS NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I), 
     A    (PUMA1_GQ_PRODS2(I,J),J=15,17)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=15,17) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED SHOP ORIGINS'
	WRITE (16,'(A)')   '  PUMA1  WORKERS NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'       
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_WORKER(I), 
     A    (PUMA1_GQ_PRODS2(I,J),J=18,20)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=18,20) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED HOME PRODUC
     ATIONS'
	WRITE (16,'(A)')   '  PUMA1 NONWORKS   SCHOOL    NH(H)   NH(NH)   
     A  SHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A------'       
	DO I=1,PUMA1
	  WRITE (16,'(I7,5F9.0)') P1_NUM(I), PUMA1_GQ_NONW(I),
     A    (PUMA1_GQ_PRODS2(I,J),J=21,24)  
	ENDDO
	
	WRITE (16,'(A,5F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=21,24) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED NONHOME ORI
     AGINS AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA1 NONWORKS   NH(H)   NH(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_NONW(I),
     A    (PUMA1_GQ_PRODS2(I,J),J=25,27)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=25,27) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED NONHOME ORI
     AGINS NOT AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA1 NONWORKS   NH(H)   NH(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_NONW(I),
     A    (PUMA1_GQ_PRODS2(I,J),J=28,30)  
	ENDDO
	
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=28,30) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED SHOP ORIGIN
     AS'
	WRITE (16,'(A)')   '  PUMA1 NONWORKS   NH(H)   NH(NH)     SHOP'   
	WRITE (16,'(A)')   '------------------------------------------'  
	DO I=1,PUMA1
	  WRITE (16,'(I7,4F9.0)') P1_NUM(I), PUMA1_GQ_NONW(I),
     A    (PUMA1_GQ_PRODS2(I,J),J=31,33)  
	ENDDO
		
	WRITE (16,'(A,4F9.0)')  '  TOTAL', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=31,33) 
C***********************************************************************
	WRITE (16,'(/A)')  'FIVE PERCENT PUMAS'

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED HOME PRODUCTIO
     ANS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS WKPL(<$) WKPL(>$) WORK
     A REL   SCHOOL  NH/W(H) NH/W(NH)     SHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----------------------------------------'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,8F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_WORKER(I), (PUMA5_GQ_PRODS2(I,J),J=1,7)  
	ENDDO

	WRITE (16,'(A,8F9.0)')  '  TOTAL       ', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=1,7) 

	WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED WORK PRODUCTIO
     ANS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS  NH/W(H) NH/W(NH)     
     ASHOP     WORK'   
	WRITE (16,'(A)')   '----------------------------------------------
     A-------------'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,5F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_WORKER(I), (PUMA5_GQ_PRODS2(I,J),J=8,11)  
	ENDDO
	WRITE (16,'(A,5F9.0)')  '  TOTAL       ',  TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=8,11) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED NONHOME/WORK O
     ARIGINS AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS  NH/W(H) NH/W(NH)     
     ASHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_WORKER(I), (PUMA5_GQ_PRODS2(I,J),J=12,14)  
	ENDDO
	WRITE (16,'(A,4F9.0)')  '  TOTAL       ', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=12,14) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED NONHOME/WORK O
     ARIGINS NOT AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS  NH/W(H) NH/W(NH)     
     ASHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_WORKER(I), (PUMA5_GQ_PRODS2(I,J),J=15,17)  
	ENDDO
	WRITE (16,'(A,4F9.0)')  '  TOTAL       ', TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=15,17) 

      WRITE (16,'(/A)')  'GROUP QUARTERS WORKER MOTORIZED SHOP ORIGINS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1  WORKERS  NH/W(H) NH/W(NH)     
     ASHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_WORKER(I), (PUMA5_GQ_PRODS2(I,J),J=18,20)  
	ENDDO
	WRITE (16,'(A,4F9.0)')  '  TOTAL       ',  TOT_GQ_WORKER,
     A  (TOT_GQ_PRODS2(J),J=18,20) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED HOME PRODUC
     ATIONS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1 NONWORKS   SCHOOL    NH(H)   NH
     A(NH)     SHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A-------------'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,5F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_NONW(I), (PUMA5_GQ_PRODS2(I,J),J=21,24)  
	ENDDO
	WRITE (16,'(A,5F9.0)')  '  TOTAL       ',  TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=21,24) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED NONHOME ORI
     AGINS AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1 NONWORKS    NH(H)   NH(NH)     
     ASHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I),
     A    PUMA5_GQ_NONW(I), (PUMA5_GQ_PRODS2(I,J),J=25,27)  
	ENDDO
	WRITE (16,'(A,4F9.0)')  '  TOTAL       ', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=25,27) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED NONHOME ORI
     AGINS NOT AT HOUSEHOLDS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1 NONWORKS    NH(H)   NH(NH)     
     ASHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I), 
     A    PUMA5_GQ_NONW(I), (PUMA5_GQ_PRODS2(I,J),J=28,30)  
	ENDDO
	WRITE (16,'(A,4F9.0)')  '  TOTAL       ', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=28,30) 

      WRITE (16,'(/A)')  'GROUP QUARTERS NONWORKER MOTORIZED SHOP ORIGIN
     AS'
	WRITE (16,'(A)')   '  PUMA5  PUMA1 NONWORKS    NH(H)   NH(NH)     
     ASHOP'   
	WRITE (16,'(A)')   '----------------------------------------------
     A----'       
	DO I=1,PUMA5
	  WRITE (16,'(2I7,4F9.0)') P5_NUM(I), P5_PUMA1(I), 
     A    PUMA5_GQ_NONW(I), (PUMA5_GQ_PRODS2(I,J),J=31,33)  
	ENDDO
	WRITE (16,'(A,4F9.0)')  '  TOTAL       ', TOT_GQ_NONW,
     A  (TOT_GQ_PRODS2(J),J=31,33) 
C
C     FINISH UP
C
 1002	CONTINUE
C
	CLOSE (40,DISP='KEEP')

      WRITE (16,'(/A)') ' END OF TRIPGEN5'
      WRITE (*,'(/A)') ' END OF TRIPGEN5'
      
	RETURN
      END